# WÃ¤hle einen Stein & setzte active_piece in Player. 

#Dialog for choosing a model (single) of a certain model type
CC "CoreUI" MODEL_SELECT_BOX modeltype:"all"
#Assignment of the model IDs to a variable
SET selectedmodelid:(VAL modelids)
#Determine wheter a model is loaded (cf. Mulit-User)
CC "Core" IS_MODEL_LOADED modelid:(selectedmodelid)
#Assignment of the loading state to a variable
SET wasloaded: (isoloaded)
#Load the model if necessary
#IF (NOT wasloaded){
#    CC "Core" LOAD_MODEL modelid:(selectedmodelid)
#}
CC "Core" LOAD_MODEL modelid:(selectedmodelid)

#Retrieve all objects of the class XXX from the current model
CC "Core" GET_ALL_OBJS_OF_CLASSNAME modelid:(selectedmodelid) classname:"Piece"
SET pieces_c_obj:(objids)

SET piece_l_obj:""

FOR i in:(pieces_c_obj) sep:" " {
    CC "Core" GET_ATTR_VAL objid:(VAL i) attrname:"Status"
    SET status_a_val:(val) 

    IF  (VAL status_a_val = 1) {
        SET piece_l_obj:(tokunion(piece_l_obj,(i), " "))
        CC "AdoScript" INFOBOX (piece_l_obj)
    }
}

CC "AdoScript" LISTBOX  entries:(piece_l_obj)
                        toksep:" "
                        title:"Example!"
                        oktext:"Click me!"
                        boxtext:"Choose your entry:"
                        selection:"Second Entry"
IF (endbutton = "ok") {
   CC "AdoScript" INFOBOX (selection)
}

SET active_piece:(selection)

CC "Core" GET_ALL_OBJS_OF_CLASSNAME modelid:(selectedmodelid) classname:"Player"
SET player_c_obj:(objids)

CC "Core"  GET_CLASS_ID classname:"Player"
SET player_c_id:(classid)

CC "Core" GET_ATTR_ID classid:(player_c_id) attrname:"active_piece"
SET activep_a_id:(attrid)


CC "Core" SET_ATTR_VAL objid:(VAL player_c_obj) attrid:(activep_a_id) val:(VAL active_piece)




#SET firstObject: (VAL token(allpieces, 0, " "))
#CC "AdoScript" INFOBOX ("first " + firstObject)

