#Gedanken
#1 chose






#Dialog for choosing a model (single) of a certain model type
CC "CoreUI" MODEL_SELECT_BOX modeltype:"all"
#Assignment of the model IDs to a variable
SET selectedmodelid:(VAL modelids)

#Determine wheter a model is loaded (cf. Mulit-User)
CC "Core" IS_MODEL_LOADED modelid:(selectedmodelid)
#Assignment of the loading state to a variable
SET wasloaded: (isoloaded)

#Load the model if necessary
#IF (NOT wasloaded){
#    CC "Core" LOAD_MODEL modelid:(selectedmodelid)
#}

CC "Core" LOAD_MODEL modelid:(selectedmodelid)

#Retrieve all objects of the class XXX from the current model
CC "Core" GET_ALL_OBJS_OF_CLASSNAME modelid:(selectedmodelid) classname:"Piece"
#Assignment of the list of objects to a variable (space seperated string)
SET allpieces:(objids)
SET result: ""

#Iterate all objects of the list
FOR i in:(allpieces) sep:" " {
    #Determine the attribute value of the attribute given by name for the object of the current iteration
    CC "Core" GET_ATTR_VAL objid: (VAL i) attrname:"Name"
    SET currentname: (val)
    CC "AdoScript" 
    #Determine all outgoing connectors of the current object
    CC "Core" GET_CONNECTORS objid: (VAL i) out
    FOR j in:(objects) sep:" " {
        #Determine the source and target objects of the given connector
        CC "Core" GET_CONNECTOR_ENDPOINTS objid:(VAL j)
        #Add the target object name to a @-separated list
        CC "Core" GET_ATTR_VAL objid:(b) attrname:"Name"
        #CC "Core" GET_ATTR_VAL objid: (toobjid ) attrname:"Name"
        SET result:(tokunion(result, (currentname + " is connected to " + val), "@"))
    }
}
#Iterate the elements of the @-seperated list
FOR i in:(result) sep:"@" {
    #Output in a infobox dialog
    CC "AdoScript" INFOBOX (i)
}
#In case the model was not loaded, discard it 
#IF (NOT wasloaded) {
#    CC "Core" DISCARD_MODEL modelid:(selectedmodelid)
#}

#CC "Core" DISCARD_MODEL modelid:(selectedmodelid)




